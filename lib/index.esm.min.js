import e from"path";import n from"fs";import s from"os";var t={},r={exports:{}};const o=n,a=e,i=s,c={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}}.version,p=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function d(e){console.log(`[dotenv@${c}][DEBUG] ${e}`)}const l={config:function(e){let n=a.resolve(process.cwd(),".env"),s="utf8";const t=Boolean(e&&e.debug),r=Boolean(e&&e.override);var c;e&&(null!=e.path&&(n="~"===(c=e.path)[0]?a.join(i.homedir(),c.slice(1)):c),null!=e.encoding&&(s=e.encoding));try{const e=l.parse(o.readFileSync(n,{encoding:s}));return Object.keys(e).forEach((function(n){Object.prototype.hasOwnProperty.call(process.env,n)?(!0===r&&(process.env[n]=e[n]),t&&d(!0===r?`"${n}" is already defined in \`process.env\` and WAS overwritten`:`"${n}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[n]=e[n]})),{parsed:e}}catch(e){return t&&d(`Failed to load ${n} ${e.message}`),{error:e}}},parse:function(e){const n={};let s,t=e.toString();for(t=t.replace(/\r\n?/gm,"\n");null!=(s=p.exec(t));){const e=s[1];let t=s[2]||"";t=t.trim();const r=t[0];t=t.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===r&&(t=t.replace(/\\n/g,"\n"),t=t.replace(/\\r/g,"\r")),n[e]=t}return n}};r.exports.config=l.config,r.exports.parse=l.parse,r.exports=l;var v=r.exports,f={};function u(e,n,s){const t=function(e,n){const s=Array.from(e.matchAll(n));return s.length>0?s.slice(-1)[0].index:-1}(e,/(?!(?<=\\))\$/g);if(-1===t)return e;const r=e.slice(t).match(/((?!(?<=\\))\${?([\w]+)(?::-([^}\\]*))?}?)/);if(null!=r){const[,t,o,a]=r;return u(e.replace(t,n[o]||a||s.parsed[o]||""),n,s)}return e}function m(e){return e.replace(/\\\$/g,"$")}f.expand=function(e){const n=e.ignoreProcessEnv?{}:process.env;for(const s in e.parsed){const t=Object.prototype.hasOwnProperty.call(n,s)?n[s]:e.parsed[s];e.parsed[s]=m(u(t,n,e))}for(const s in e.parsed)n[s]=e.parsed[s];return e};const g=e,{config:y,decrypt:j,parse:b}=v,{expand:h}=f,w=/(?<content>.*)::(?<type>\w*)$/,$=g.resolve(process.cwd(),".env.default"),x=g.resolve(process.cwd(),`.env.${process.env.CONFIG_ENV||"development"}`),k=(e,n)=>{if(!w.test(e))return e;const{type:s,content:t}=w.exec(e).groups;switch(s){case"number":case"int":case"float":return+t;case"json":return JSON.parse(t);case"date":return new Date(t);default:return n[s](t)}};var O=t.config=y,E=t.decrypt=j,S=t.parse=b,D=t.expand=h,A=t.load=(e={},n={})=>{const s=h(y({path:$})),t=h(y({path:x,...e})),r={...s.parsed,...t?.parsed};let o={};for(const e in r)o[e]=k(r[e]);return o},B=t.convert=k;export{O as config,B as convert,E as decrypt,t as default,D as expand,A as load,S as parse};
