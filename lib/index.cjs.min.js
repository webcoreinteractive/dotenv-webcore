"use strict";var e=require("node:path"),t=require("fs"),s=require("path"),r=require("os"),o=require("stream"),i=require("zlib"),n=require("buffer"),a=require("crypto"),c=require("events"),l=require("https"),d=require("http"),h=require("net"),f=require("tls"),u=require("url"),p=require("child_process"),_=require("node:os"),m=require("node:child_process"),g=require("node:util");function y(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var v=y(e),k=y(t),b=y(s),S=y(r),W=y(o),w=y(i),E=y(n),x=y(a),O=y(c),N=y(l),C=y(d),R=y(h),L=y(f),T=y(u),P=y(p),I=y(_);function B(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M={exports:{}},U={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}};const G=k.default,F=b.default,A=S.default,j=U.version,D=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function q(e){console.log(`[dotenv@${j}][DEBUG] ${e}`)}const V={config:function(e){let t=F.resolve(process.cwd(),".env"),s="utf8";const r=Boolean(e&&e.debug),o=Boolean(e&&e.override);var i;e&&(null!=e.path&&(t="~"===(i=e.path)[0]?F.join(A.homedir(),i.slice(1)):i),null!=e.encoding&&(s=e.encoding));try{const e=V.parse(G.readFileSync(t,{encoding:s}));return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(process.env,t)?(!0===o&&(process.env[t]=e[t]),r&&q(!0===o?`"${t}" is already defined in \`process.env\` and WAS overwritten`:`"${t}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[t]=e[t]})),{parsed:e}}catch(e){return r&&q(`Failed to load ${t} ${e.message}`),{error:e}}},parse:function(e){const t={};let s,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(s=D.exec(r));){const e=s[1];let r=s[2]||"";r=r.trim();const o=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===o&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),t[e]=r}return t}};var $=M.exports.config=V.config,H=M.exports.parse=V.parse;M.exports=V;var J=M.exports;function Q(e,t,s){const r=function(e,t){const s=Array.from(e.matchAll(t));return s.length>0?s.slice(-1)[0].index:-1}(e,/(?!(?<=\\))\$/g);if(-1===r)return e;const o=e.slice(r).match(/((?!(?<=\\))\${?([\w]+)(?::-([^}\\]*))?}?)/);if(null!=o){const[,r,i,n]=o;return Q(e.replace(r,t[i]||n||s.parsed[i]||""),t,s)}return e}function Z(e){return e.replace(/\\\$/g,"$")}var K=function(e){const t=e.ignoreProcessEnv?{}:process.env;for(const s in e.parsed){const r=Object.prototype.hasOwnProperty.call(t,s)?t[s]:e.parsed[s];e.parsed[s]=Z(Q(r,t,e))}for(const s in e.parsed)t[s]=e.parsed[s];return e},z={exports:{}},Y={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}};const{EMPTY_BUFFER:X}=Y,ee=Buffer[Symbol.species];function te(e,t,s,r,o){for(let i=0;i<o;i++)s[r+i]=e[i]^t[3&i]}function se(e,t){for(let s=0;s<e.length;s++)e[s]^=t[3&s]}if(z.exports={concat:function(e,t){if(0===e.length)return X;if(1===e.length)return e[0];const s=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const o=e[t];s.set(o,r),r+=o.length}return r<t?new ee(s.buffer,s.byteOffset,r):s},mask:te,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let s;return t instanceof ArrayBuffer?s=new ee(t):ArrayBuffer.isView(t)?s=new ee(t.buffer,t.byteOffset,t.byteLength):(s=Buffer.from(t),e.readOnly=!1),s},unmask:se},!process.env.WS_NO_BUFFER_UTIL)try{const e=require("bufferutil");z.exports.mask=function(t,s,r,o,i){i<48?te(t,s,r,o,i):e.mask(t,s,r,o,i)},z.exports.unmask=function(t,s){t.length<32?se(t,s):e.unmask(t,s)}}catch(e){}var re=z.exports;const oe=Symbol("kDone"),ie=Symbol("kRun");var ne=class{constructor(e){this[oe]=()=>{this.pending--,this[ie]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[ie]()}[ie](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[oe])}}};const ae=w.default,ce=re,le=ne,{kStatusCode:de}=Y,he=Buffer[Symbol.species],fe=Buffer.from([0,0,255,255]),ue=Symbol("permessage-deflate"),pe=Symbol("total-length"),_e=Symbol("callback"),me=Symbol("buffers"),ge=Symbol("error");let ye;var ve=class{constructor(e,t,s){if(this._maxPayload=0|s,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!ye){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;ye=new le(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[_e];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,s=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!s)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(s.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?s.client_max_window_bits=t.clientMaxWindowBits:!0!==s.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete s.client_max_window_bits,s}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let s=e[t];if(s.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(s=s[0],"client_max_window_bits"===t){if(!0!==s){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}else if("server_max_window_bits"===t){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==s)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}e[t]=s}))})),e}decompress(e,t,s){ye.add((r=>{this._decompress(e,t,((e,t)=>{r(),s(e,t)}))}))}compress(e,t,s){ye.add((r=>{this._compress(e,t,((e,t)=>{r(),s(e,t)}))}))}_decompress(e,t,s){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?ae.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=ae.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[ue]=this,this._inflate[pe]=0,this._inflate[me]=[],this._inflate.on("error",Se),this._inflate.on("data",be)}this._inflate[_e]=s,this._inflate.write(e),t&&this._inflate.write(fe),this._inflate.flush((()=>{const e=this._inflate[ge];if(e)return this._inflate.close(),this._inflate=null,void s(e);const o=ce.concat(this._inflate[me],this._inflate[pe]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[pe]=0,this._inflate[me]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),s(null,o)}))}_compress(e,t,s){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?ae.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=ae.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[pe]=0,this._deflate[me]=[],this._deflate.on("data",ke)}this._deflate[_e]=s,this._deflate.write(e),this._deflate.flush(ae.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=ce.concat(this._deflate[me],this._deflate[pe]);t&&(e=new he(e.buffer,e.byteOffset,e.length-4)),this._deflate[_e]=null,this._deflate[pe]=0,this._deflate[me]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),s(null,e)}))}};function ke(e){this[me].push(e),this[pe]+=e.length}function be(e){this[pe]+=e.length,this[ue]._maxPayload<1||this[pe]<=this[ue]._maxPayload?this[me].push(e):(this[ge]=new RangeError("Max payload size exceeded"),this[ge].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[ge][de]=1009,this.removeListener("data",be),this.reset())}function Se(e){this[ue]._inflate=null,e[de]=1007,this[_e](e)}var We={exports:{}};const{isUtf8:we}=E.default;function Ee(e){const t=e.length;let s=0;for(;s<t;)if(0==(128&e[s]))s++;else if(192==(224&e[s])){if(s+1===t||128!=(192&e[s+1])||192==(254&e[s]))return!1;s+=2}else if(224==(240&e[s])){if(s+2>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||224===e[s]&&128==(224&e[s+1])||237===e[s]&&160==(224&e[s+1]))return!1;s+=3}else{if(240!=(248&e[s]))return!1;if(s+3>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||128!=(192&e[s+3])||240===e[s]&&128==(240&e[s+1])||244===e[s]&&e[s+1]>143||e[s]>244)return!1;s+=4}return!0}if(We.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:Ee,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},we)We.exports.isValidUTF8=function(e){return e.length<24?Ee(e):we(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const e=require("utf-8-validate");We.exports.isValidUTF8=function(t){return t.length<32?Ee(t):e(t)}}catch(e){}var xe=We.exports;const{Writable:Oe}=W.default,Ne=ve,{BINARY_TYPES:Ce,EMPTY_BUFFER:Re,kStatusCode:Le,kWebSocket:Te}=Y,{concat:Pe,toArrayBuffer:Ie,unmask:Be}=re,{isValidStatusCode:Me,isValidUTF8:Ue}=xe,Ge=Buffer[Symbol.species],Fe=Promise.resolve(),Ae="function"==typeof queueMicrotask?queueMicrotask:function(e){Fe.then(e).catch(Ve)};var je=class extends Oe{constructor(e={}){super(),this._allowMultipleEventsPerMicrotask=!!e.allowMultipleEventsPerMicrotask,this._binaryType=e.binaryType||Ce[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Te]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,s){if(8===this._opcode&&0==this._state)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new Ge(t.buffer,t.byteOffset+e,t.length-e),new Ge(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const s=this._buffers[0],r=t.length-e;e>=s.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(s.buffer,s.byteOffset,e),r),this._buffers[0]=new Ge(s.buffer,s.byteOffset+e,s.length-e)),e-=s.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;case 5:return void(this._loop=!1);default:return this._loop=!1,void Ae((()=>{this._state=0,this.startLoop(e)}))}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,De(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[Ne.extensionName])return this._loop=!1,De(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,De(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,De(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,De(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,De(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,De(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,De(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return this._loop=!1,De(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,De(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,De(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,De(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,De(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=Re;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&Be(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[Ne.extensionName].decompress(e,this._fin,((e,s)=>{if(e)return t(e);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(De(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(s)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let s;s="nodebuffer"===this._binaryType?Pe(t,e):"arraybuffer"===this._binaryType?Ie(Pe(t,e)):t,this.emit("message",s,!0)}else{const s=Pe(t,e);if(!this._skipUTF8Validation&&!Ue(s))return this._loop=!1,De(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=this._allowMultipleEventsPerMicrotask?0:6}controlMessage(e){if(8!==this._opcode)this.emit(9===this._opcode?"ping":"pong",e),this._state=this._allowMultipleEventsPerMicrotask?0:6;else{if(this._loop=!1,0===e.length)this.emit("conclude",1005,Re),this.end();else{const t=e.readUInt16BE(0);if(!Me(t))return De(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const s=new Ge(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Ue(s))return De(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,s),this.end()}this._state=0}}};function De(e,t,s,r,o){const i=new e(s?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(i,De),i.code=o,i[Le]=r,i}function qe(e){throw e}function Ve(e){process.nextTick(qe,e)}const{randomFillSync:$e}=x.default,He=ve,{EMPTY_BUFFER:Je}=Y,{isValidStatusCode:Qe}=xe,{mask:Ze,toBuffer:Ke}=re,ze=Symbol("kByteLength"),Ye=Buffer.alloc(4);class Xe{constructor(e,t,s){this._extensions=t||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let s,r,o=!1,i=2,n=!1;t.mask&&(s=t.maskBuffer||Ye,t.generateMask?t.generateMask(s):$e(s,0,4),n=0==(s[0]|s[1]|s[2]|s[3]),i=6),"string"==typeof e?r=t.mask&&!n||void 0===t[ze]?(e=Buffer.from(e)).length:t[ze]:(r=e.length,o=t.mask&&t.readOnly&&!n);let a=r;r>=65536?(i+=8,a=127):r>125&&(i+=2,a=126);const c=Buffer.allocUnsafe(o?r+i:i);return c[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(c[0]|=64),c[1]=a,126===a?c.writeUInt16BE(r,2):127===a&&(c[2]=c[3]=0,c.writeUIntBE(r,4,6)),t.mask?(c[1]|=128,c[i-4]=s[0],c[i-3]=s[1],c[i-2]=s[2],c[i-1]=s[3],n?[c,e]:o?(Ze(e,s,c,i,r),[c]):(Ze(e,s,e,0,r),[c,e])):[c,e]}close(e,t,s,r){let o;if(void 0===e)o=Je;else{if("number"!=typeof e||!Qe(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const s=Buffer.byteLength(t);if(s>123)throw new RangeError("The message must not be greater than 123 bytes");o=Buffer.allocUnsafe(2+s),o.writeUInt16BE(e,0),"string"==typeof t?o.write(t,2):o.set(t,2)}else o=Buffer.allocUnsafe(2),o.writeUInt16BE(e,0)}const i={[ze]:o.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,o,!1,i,r]):this.sendFrame(Xe.frame(o,i),r)}ping(e,t,s){let r,o;if("string"==typeof e?(r=Buffer.byteLength(e),o=!1):(r=(e=Ke(e)).length,o=Ke.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const i={[ze]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,i,s]):this.sendFrame(Xe.frame(e,i),s)}pong(e,t,s){let r,o;if("string"==typeof e?(r=Buffer.byteLength(e),o=!1):(r=(e=Ke(e)).length,o=Ke.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const i={[ze]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,i,s]):this.sendFrame(Xe.frame(e,i),s)}send(e,t,s){const r=this._extensions[He.extensionName];let o,i,n=t.binary?2:1,a=t.compress;if("string"==typeof e?(o=Buffer.byteLength(e),i=!1):(o=(e=Ke(e)).length,i=Ke.readOnly),this._firstFragment?(this._firstFragment=!1,a&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=o>=r._threshold),this._compress=a):(a=!1,n=0),t.fin&&(this._firstFragment=!0),r){const r={[ze]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:i,rsv1:a};this._deflating?this.enqueue([this.dispatch,e,this._compress,r,s]):this.dispatch(e,this._compress,r,s)}else this.sendFrame(Xe.frame(e,{[ze]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:i,rsv1:!1}),s)}dispatch(e,t,s,r){if(!t)return void this.sendFrame(Xe.frame(e,s),r);const o=this._extensions[He.extensionName];this._bufferedBytes+=s[ze],this._deflating=!0,o.compress(e,s.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof r&&r(e);for(let t=0;t<this._queue.length;t++){const s=this._queue[t],r=s[s.length-1];"function"==typeof r&&r(e)}}else this._bufferedBytes-=s[ze],this._deflating=!1,s.readOnly=!1,this.sendFrame(Xe.frame(t,s),r),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][ze],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][ze],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}var et=Xe;const{kForOnEventAttribute:tt,kListener:st}=Y,rt=Symbol("kCode"),ot=Symbol("kData"),it=Symbol("kError"),nt=Symbol("kMessage"),at=Symbol("kReason"),ct=Symbol("kTarget"),lt=Symbol("kType"),dt=Symbol("kWasClean");class ht{constructor(e){this[ct]=null,this[lt]=e}get target(){return this[ct]}get type(){return this[lt]}}Object.defineProperty(ht.prototype,"target",{enumerable:!0}),Object.defineProperty(ht.prototype,"type",{enumerable:!0});class ft extends ht{constructor(e,t={}){super(e),this[rt]=void 0===t.code?0:t.code,this[at]=void 0===t.reason?"":t.reason,this[dt]=void 0!==t.wasClean&&t.wasClean}get code(){return this[rt]}get reason(){return this[at]}get wasClean(){return this[dt]}}Object.defineProperty(ft.prototype,"code",{enumerable:!0}),Object.defineProperty(ft.prototype,"reason",{enumerable:!0}),Object.defineProperty(ft.prototype,"wasClean",{enumerable:!0});class ut extends ht{constructor(e,t={}){super(e),this[it]=void 0===t.error?null:t.error,this[nt]=void 0===t.message?"":t.message}get error(){return this[it]}get message(){return this[nt]}}Object.defineProperty(ut.prototype,"error",{enumerable:!0}),Object.defineProperty(ut.prototype,"message",{enumerable:!0});class pt extends ht{constructor(e,t={}){super(e),this[ot]=void 0===t.data?null:t.data}get data(){return this[ot]}}Object.defineProperty(pt.prototype,"data",{enumerable:!0});const _t={addEventListener(e,t,s={}){for(const r of this.listeners(e))if(!s[tt]&&r[st]===t&&!r[tt])return;let r;if("message"===e)r=function(e,s){const r=new pt("message",{data:s?e:e.toString()});r[ct]=this,gt(t,this,r)};else if("close"===e)r=function(e,s){const r=new ft("close",{code:e,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[ct]=this,gt(t,this,r)};else if("error"===e)r=function(e){const s=new ut("error",{error:e,message:e.message});s[ct]=this,gt(t,this,s)};else{if("open"!==e)return;r=function(){const e=new ht("open");e[ct]=this,gt(t,this,e)}}r[tt]=!!s[tt],r[st]=t,s.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const s of this.listeners(e))if(s[st]===t&&!s[tt]){this.removeListener(e,s);break}}};var mt={CloseEvent:ft,ErrorEvent:ut,Event:ht,EventTarget:_t,MessageEvent:pt};function gt(e,t,s){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,s):e.call(t,s)}const{tokenChars:yt}=xe;function vt(e,t,s){void 0===e[t]?e[t]=[s]:e[t].push(s)}var kt={format:function(e){return Object.keys(e).map((t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map((e=>[t].concat(Object.keys(e).map((t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let s,r,o=Object.create(null),i=!1,n=!1,a=!1,c=-1,l=-1,d=-1,h=0;for(;h<e.length;h++)if(l=e.charCodeAt(h),void 0===s)if(-1===d&&1===yt[l])-1===c&&(c=h);else if(0===h||32!==l&&9!==l){if(59!==l&&44!==l)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${h}`);-1===d&&(d=h);const r=e.slice(c,d);44===l?(vt(t,r,o),o=Object.create(null)):s=r,c=d=-1}}else-1===d&&-1!==c&&(d=h);else if(void 0===r)if(-1===d&&1===yt[l])-1===c&&(c=h);else if(32===l||9===l)-1===d&&-1!==c&&(d=h);else if(59===l||44===l){if(-1===c)throw new SyntaxError(`Unexpected character at index ${h}`);-1===d&&(d=h),vt(o,e.slice(c,d),!0),44===l&&(vt(t,s,o),o=Object.create(null),s=void 0),c=d=-1}else{if(61!==l||-1===c||-1!==d)throw new SyntaxError(`Unexpected character at index ${h}`);r=e.slice(c,h),c=d=-1}else if(n){if(1!==yt[l])throw new SyntaxError(`Unexpected character at index ${h}`);-1===c?c=h:i||(i=!0),n=!1}else if(a)if(1===yt[l])-1===c&&(c=h);else if(34===l&&-1!==c)a=!1,d=h;else{if(92!==l)throw new SyntaxError(`Unexpected character at index ${h}`);n=!0}else if(34===l&&61===e.charCodeAt(h-1))a=!0;else if(-1===d&&1===yt[l])-1===c&&(c=h);else if(-1===c||32!==l&&9!==l){if(59!==l&&44!==l)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${h}`);-1===d&&(d=h);let n=e.slice(c,d);i&&(n=n.replace(/\\/g,""),i=!1),vt(o,r,n),44===l&&(vt(t,s,o),o=Object.create(null),s=void 0),r=void 0,c=d=-1}}else-1===d&&(d=h);if(-1===c||a||32===l||9===l)throw new SyntaxError("Unexpected end of input");-1===d&&(d=h);const f=e.slice(c,d);return void 0===s?vt(t,f,o):(void 0===r?vt(o,f,!0):vt(o,r,i?f.replace(/\\/g,""):f),vt(t,s,o)),t}};const bt=O.default,St=N.default,Wt=C.default,wt=R.default,Et=L.default,{randomBytes:xt,createHash:Ot}=x.default,{URL:Nt}=T.default,Ct=ve,Rt=je,Lt=et,{BINARY_TYPES:Tt,EMPTY_BUFFER:Pt,GUID:It,kForOnEventAttribute:Bt,kListener:Mt,kStatusCode:Ut,kWebSocket:Gt,NOOP:Ft}=Y,{EventTarget:{addEventListener:At,removeEventListener:jt}}=mt,{format:Dt,parse:qt}=kt,{toBuffer:Vt}=re,$t=Symbol("kAborted"),Ht=[8,13],Jt=["CONNECTING","OPEN","CLOSING","CLOSED"],Qt=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class Zt extends bt{constructor(e,t,s){super(),this._binaryType=Tt[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Pt,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=Zt.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(s=t,t=[]):t=[t]),Kt(this,e,t,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){Tt.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,s){const r=new Rt({allowMultipleEventsPerMicrotask:s.allowMultipleEventsPerMicrotask,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new Lt(e,this._extensions,s.generateMask),this._receiver=r,this._socket=e,r[Gt]=this,e[Gt]=this,r.on("conclude",ss),r.on("drain",rs),r.on("error",os),r.on("message",ns),r.on("ping",as),r.on("pong",cs),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",ds),e.on("data",hs),e.on("end",fs),e.on("error",us),this._readyState=Zt.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=Zt.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[Ct.extensionName]&&this._extensions[Ct.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=Zt.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==Zt.CLOSED)if(this.readyState!==Zt.CONNECTING)this.readyState!==Zt.CLOSING?(this._readyState=Zt.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";es(this,this._req,e)}}pause(){this.readyState!==Zt.CONNECTING&&this.readyState!==Zt.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,s){if(this.readyState===Zt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Zt.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||Pt,t,s)):ts(this,e,s)}pong(e,t,s){if(this.readyState===Zt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Zt.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||Pt,t,s)):ts(this,e,s)}resume(){this.readyState!==Zt.CONNECTING&&this.readyState!==Zt.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,s){if(this.readyState===Zt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(s=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==Zt.OPEN)return void ts(this,e,s);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[Ct.extensionName]||(r.compress=!1),this._sender.send(e||Pt,r,s)}terminate(){if(this.readyState!==Zt.CLOSED)if(this.readyState!==Zt.CONNECTING)this._socket&&(this._readyState=Zt.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";es(this,this._req,e)}}}function Kt(e,t,s,r){const o={allowMultipleEventsPerMicrotask:!1,protocolVersion:Ht[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Ht.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${Ht.join(", ")})`);let i;if(t instanceof Nt)i=t;else try{i=new Nt(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===i.protocol?i.protocol="ws:":"https:"===i.protocol&&(i.protocol="wss:"),e._url=i.href;const n="wss:"===i.protocol,a="ws+unix:"===i.protocol;let c;if("ws:"===i.protocol||n||a?a&&!i.pathname?c="The URL's pathname is empty":i.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',c){const t=new SyntaxError(c);if(0===e._redirects)throw t;return void zt(e,t)}const l=n?443:80,d=xt(16).toString("base64"),h=n?St.request:Wt.request,f=new Set;let u,p;if(o.createConnection=n?Xt:Yt,o.defaultPort=o.defaultPort||l,o.port=i.port||l,o.host=i.hostname.startsWith("[")?i.hostname.slice(1,-1):i.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":d,Connection:"Upgrade",Upgrade:"websocket"},o.path=i.pathname+i.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(u=new Ct(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=Dt({[Ct.extensionName]:u.offer()})),s.length){for(const e of s){if("string"!=typeof e||!Qt.test(e)||f.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");f.add(e)}o.headers["Sec-WebSocket-Protocol"]=s.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(i.username||i.password)&&(o.auth=`${i.username}:${i.password}`),a){const e=o.path.split(":");o.socketPath=e[0],o.path=e[1]}if(o.followRedirects){if(0===e._redirects){e._originalIpc=a,e._originalSecure=n,e._originalHostOrSocketPath=a?o.socketPath:i.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,s]of Object.entries(t))r.headers[e.toLowerCase()]=s}else if(0===e.listenerCount("redirect")){const t=a?!!e._originalIpc&&o.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&i.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!n)&&(delete o.headers.authorization,delete o.headers.cookie,t||delete o.headers.host,o.auth=void 0)}o.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),p=e._req=h(o),e._redirects&&e.emit("redirect",e.url,p)}else p=e._req=h(o);o.timeout&&p.on("timeout",(()=>{es(e,p,"Opening handshake has timed out")})),p.on("error",(t=>{null===p||p[$t]||(p=e._req=null,zt(e,t))})),p.on("response",(i=>{const n=i.headers.location,a=i.statusCode;if(n&&o.followRedirects&&a>=300&&a<400){if(++e._redirects>o.maxRedirects)return void es(e,p,"Maximum redirects exceeded");let i;p.abort();try{i=new Nt(n,t)}catch(t){const s=new SyntaxError(`Invalid URL: ${n}`);return void zt(e,s)}Kt(e,i,s,r)}else e.emit("unexpected-response",p,i)||es(e,p,`Unexpected server response: ${i.statusCode}`)})),p.on("upgrade",((t,s,r)=>{if(e.emit("upgrade",t),e.readyState!==Zt.CONNECTING)return;if(p=e._req=null,"websocket"!==t.headers.upgrade.toLowerCase())return void es(e,s,"Invalid Upgrade header");const i=Ot("sha1").update(d+It).digest("base64");if(t.headers["sec-websocket-accept"]!==i)return void es(e,s,"Invalid Sec-WebSocket-Accept header");const n=t.headers["sec-websocket-protocol"];let a;if(void 0!==n?f.size?f.has(n)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":f.size&&(a="Server sent no subprotocol"),a)return void es(e,s,a);n&&(e._protocol=n);const c=t.headers["sec-websocket-extensions"];if(void 0!==c){if(!u){return void es(e,s,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=qt(c)}catch(t){return void es(e,s,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==Ct.extensionName){return void es(e,s,"Server indicated an extension that was not requested")}try{u.accept(t[Ct.extensionName])}catch(t){return void es(e,s,"Invalid Sec-WebSocket-Extensions header")}e._extensions[Ct.extensionName]=u}e.setSocket(s,r,{allowMultipleEventsPerMicrotask:o.allowMultipleEventsPerMicrotask,generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})})),o.finishRequest?o.finishRequest(p,e):p.end()}function zt(e,t){e._readyState=Zt.CLOSING,e.emit("error",t),e.emitClose()}function Yt(e){return e.path=e.socketPath,wt.connect(e)}function Xt(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=wt.isIP(e.host)?"":e.host),Et.connect(e)}function es(e,t,s){e._readyState=Zt.CLOSING;const r=new Error(s);Error.captureStackTrace(r,es),t.setHeader?(t[$t]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(zt,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function ts(e,t,s){if(t){const s=Vt(t).length;e._socket?e._sender._bufferedBytes+=s:e._bufferedAmount+=s}if(s){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${Jt[e.readyState]})`);process.nextTick(s,t)}}function ss(e,t){const s=this[Gt];s._closeFrameReceived=!0,s._closeMessage=t,s._closeCode=e,void 0!==s._socket[Gt]&&(s._socket.removeListener("data",hs),process.nextTick(ls,s._socket),1005===e?s.close():s.close(e,t))}function rs(){const e=this[Gt];e.isPaused||e._socket.resume()}function os(e){const t=this[Gt];void 0!==t._socket[Gt]&&(t._socket.removeListener("data",hs),process.nextTick(ls,t._socket),t.close(e[Ut])),t.emit("error",e)}function is(){this[Gt].emitClose()}function ns(e,t){this[Gt].emit("message",e,t)}function as(e){const t=this[Gt];t.pong(e,!t._isServer,Ft),t.emit("ping",e)}function cs(e){this[Gt].emit("pong",e)}function ls(e){e.resume()}function ds(){const e=this[Gt];let t;this.removeListener("close",ds),this.removeListener("data",hs),this.removeListener("end",fs),e._readyState=Zt.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[Gt]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",is),e._receiver.on("finish",is))}function hs(e){this[Gt]._receiver.write(e)||this.pause()}function fs(){const e=this[Gt];e._readyState=Zt.CLOSING,e._receiver.end(),this.end()}function us(){const e=this[Gt];this.removeListener("error",us),this.on("error",Ft),e&&(e._readyState=Zt.CLOSING,this.destroy())}Object.defineProperty(Zt,"CONNECTING",{enumerable:!0,value:Jt.indexOf("CONNECTING")}),Object.defineProperty(Zt.prototype,"CONNECTING",{enumerable:!0,value:Jt.indexOf("CONNECTING")}),Object.defineProperty(Zt,"OPEN",{enumerable:!0,value:Jt.indexOf("OPEN")}),Object.defineProperty(Zt.prototype,"OPEN",{enumerable:!0,value:Jt.indexOf("OPEN")}),Object.defineProperty(Zt,"CLOSING",{enumerable:!0,value:Jt.indexOf("CLOSING")}),Object.defineProperty(Zt.prototype,"CLOSING",{enumerable:!0,value:Jt.indexOf("CLOSING")}),Object.defineProperty(Zt,"CLOSED",{enumerable:!0,value:Jt.indexOf("CLOSED")}),Object.defineProperty(Zt.prototype,"CLOSED",{enumerable:!0,value:Jt.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(Zt.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(Zt.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[Bt])return t[Mt];return null},set(t){for(const t of this.listeners(e))if(t[Bt]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[Bt]:!0})}})})),Zt.prototype.addEventListener=At,Zt.prototype.removeEventListener=jt;var ps,_s,ms,gs,ys,vs=B(Zt),ks={exports:{}},bs={};function Ss(){if(ps)return bs;return ps=1,bs.isCapitals=function(e){return"string"==typeof e&&e.length>0&&e.split("").reduce((function(e,t){return e&&"A"<=t&&t<="Z"}),!0)},bs.isDigits=function(e){return"string"==typeof e&&e.length>0&&e.split("").reduce((function(e,t){return e&&"0"<=t&&t<="9"}),!0)},bs}"win32"===S.default.platform()?ks.exports=function(){if(ms)return _s;ms=1;var e=P.default.exec,t=b.default,s=Ss();function r(e,t){var r=e.replace(/\r\n/g,"\n").split("\n").filter((function(e){return e.replace(/\s+/g,"").length>0}));if(r.length<=1)throw new Error("Unexpected WMIC output: ["+e+"]");var i=r.splice(1).map((function(t){var r,i=t.split(" ").filter((function(e){return""!==e})),n="0",a="0";if(o(i[0])?r=i[0]:(n=i[0],r=i[1],a=i[2]),!(o(r)&&s.isDigits(n)&&s.isDigits(a)))throw new Error("Unexpected WMIC output ["+e+"]");return{disk:r,total:+a,available:+n}})).reduce((function(e,t){return e[t.disk]=t,e}),{})[t];if(!i)throw new Error("Unknown disk ["+t+"]");return{total:i.total,used:i.total-i.available,available:i.available}}function o(e){var t=e.length-1;return"string"==typeof e&&":"===e[t]&&s.isCapitals(e.substr(0,t))}return _s={diskusage:function(s,i){e("WMIC LOGICALDISK GET Name,Size,FreeSpace",{windowsHide:!0},(function(e,n){if(e)return i(e);try{i(null,r(n,function(e){var s=t.parse(t.normalize(e)).root.split("\\")[0].toUpperCase();if(!o(s))throw new Error("Bad path");return s}(s)))}catch(e){i(e)}}))},parse:r},_s}().diskusage:ks.exports=function(){if(ys)return gs;ys=1;var e=P.default.execFile;function t(e){var t=e.split("\n");if(!t[1])throw new Error("Unexpected df output: ["+e+"]");var s=t[1].match(/^.+\s+(\d+)\s+(\d+)\s+(\d+)\s+\d+%\s+.+$/);if(!s||4!==s.length)throw new Error("Unexpected df output: ["+e+"]");return{total:1024*s[1],used:1024*s[2],available:1024*s[3]}}return Ss().isDigits,gs={diskusage:function(s,r){e("df",["-P","-k",s],(function(e,s){if(e)return r(e);try{r(null,t(s))}catch(e){r(e)}}))},parse:t},gs}().diskusage;var Ws=B(ks.exports);const ws=Es;function Es(e,t){const s=Ns();return Es=function(t,r){let o=s[t-=484];if(void 0===Es.oLIPVa){const t=function(e,t){let s,r,o=[],i=0,n="";for(e=function(e){let t="",s="";for(let s,r,o=0,i=0;r=e.charAt(i++);~r&&(s=o%4?64*s+r:r,o++%4)?t+=String.fromCharCode(255&s>>(-2*o&6)):0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let e=0,r=t.length;e<r;e++)s+="%"+("00"+t.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(s)}(e),r=0;r<256;r++)o[r]=r;for(r=0;r<256;r++)i=(i+o[r]+t.charCodeAt(r%t.length))%256,s=o[r],o[r]=o[i],o[i]=s;r=0,i=0;for(let t=0;t<e.length;t++)r=(r+1)%256,i=(i+o[r])%256,s=o[r],o[r]=o[i],o[i]=s,n+=String.fromCharCode(e.charCodeAt(t)^o[(o[r]+o[i])%256]);return n};Es.jqOGEJ=t,e=arguments,Es.oLIPVa=!0}const i=t+s[0],n=e[i];return n?o=n:(void 0===Es.nOpoSk&&(Es.nOpoSk=!0),o=Es.jqOGEJ(o,r),e[i]=o),o},Es(e,t)}!function(e,t){const s=Es,r=Ns();for(;;)try{if(544333===-parseInt(s(498,"eyeW"))/1*(parseInt(s(594,"lTAl"))/2)+parseInt(s(574,"dHV9"))/3+-parseInt(s(507,"VFYg"))/4*(parseInt(s(522,"mO(l"))/5)+-parseInt(s(572,"0IZx"))/6+-parseInt(s(586,"22!Z"))/7*(-parseInt(s(551,"VFYg"))/8)+-parseInt(s(486,"cbiB"))/9+parseInt(s(555,")Nfn"))/10)break;r.push(r.shift())}catch(e){r.push(r.shift())}}();let xs=0;const Os=!1;function Ns(){const e=["ovxdSrNdKCk2WQNdNSkHWQq","oJa2WPigA8kaW50havv8bG","W7pcHrzkeIjboxaI","icLxfeDyuXRdJq","WOVdQ8o8WQi","W53cUSkugq","W6NcU8olo8kFxCoNchLI","W5FcHCoRhhO5k8kyWQdcGW","EeCVrgBdNCkk","W47cHmoV","WQRdRCkzzSoah8k3xc17WRNcGZJcMW","WPVdVZ/dGJVcLqdcLW","WP0Wtau","W7NcQ8obmSkstSoWvI5Z","h8kbWRNcJa","W4WCh1i","W6WjW47dGmoZWQTmuW","W7beW7tcN8ohWQtdNa","W5FcMCkJfq","W73cOhynW7TJy8k6oSkI","W5VdM8owfCouEGjrzG","WONdTSo7WRpdICkUW7JcTW","WP56omoAW6tcGeZdS8oOW4u","WRBcOSkm","WRZcRI3cGdiGWR4","pGZcGmkNWRtcKt/cJfK","idHlgq","DLpdTXldJ8kNWQJcKmkJWRG","FNbKW5jzp8oFW6jZyG","W6L5gG","WOSuy8oaW65iag9c","mKFdSrldJ8k6WRxcG8oIWQS","W7LmW4BdNmo0o8kIW74","W40ChfNdOmkGW7ldVCoJWQi","WRmTr8kcW53dMmo+","krhcLmkOW6ddLG","WQiKtSkgW5ldVSoR","lLpdUG/dTmk9WR3cIW","W4xcHCkKhIhcK8kVwLjf","WO3cKGtcSq0xW75zW6PP","W7pdH8oBcq","WPmOWOJdNSotc8kKn2FdJa","WPOjDmoo","rWJcOWq","dSkLkmo2WRTbWOi","ote2WPGcAmoFW6epmNHA","WOBdVmo4WRpdN8kMW74","WQXciSkXmmoY","WQqHW5tdTmkpdW","W50SzmknWQtdKtxcQSoVW5JdTmouWQJdRW","WOldOZ0","luxdRq7dLmk8WRu","cmkNkmoL","WQu7uh9WnKCPW6pcGG","gCo8CgK","qWJcTH3cGW","jCoauW","dNNdIX8","ArlcQexcImoLWRBcGSkeWRZdVGm","WQ51oCkVBrG","CmkNW5CNW7LGWParW5JdOa","W7f1fq","WRzqW5FdTmkqW4e","WRXZmmoI","WO06vW/dKslcRCoOcW","W7tdNmoxf3aes8oSWQZdMG","WPNdQCocsuDYWPJcImonlHBdPG","WOH6i8oqW77cINddT8o+W58","wmk1W53dO8kAWOXItSkZWRJcRtpdSW","WQC3W5xcO8ojtSkNaCoR","WRFdMSklW5i","W6VcOgipW6bOr8k2nG","W5BcJSo7cq","WQPyn8kGBSk7zq","W5lcMCoNgxO9n8kfWORcLq","WRtdHCkj","W7pdM8omfgy","W6xdNc/cGCkbnwZdHZFcUG","W69eW6tcG8oiWQ3dNauHFa","DmkXWPKM","WQpcICoDWRpdPSkWW7Gq","oJn0W7HUfmoOW4m","WOPWj8oWW7pcHMG","zSo7W4b+","g8oTBt0yWRpdPmoJvHW","WONdOCo6WQpdI8k8","WPmEDG","gmoLWONcTmoAW50Bq8kVWQu","DmkAfmkUW4LBxr9tsW","W6tdLCoUWRBdUmkjW5mF","WP3dP8oNWR/dLCkOW6xcTeO","W7rnW5ddMSo7lSkQWRtcRCoC","lIaXneBdSCoIvq","osO1iupdS8oP","dSk5omoK","W4hcHmoMe2O9n8kjWOe","imkRWP0RWPddPmomi8ooW7iXW7OT","W4Hbq8oCW79WohK","pYeGjW","kcOMmepdQSoIxb/dIG","WRfwW5W","W5ZdLSougq","E13dPHvefSoKW7NdGde","W5/dSGBcU8kGdJm","gCkQFxqBWRpdTSoKgG","uWRcSbVcNmkp","hX3dT8kw","dCkwWRtcGa","WR7cIxtcRCkfh3pdI2e","WPmGWOZcHmkebSkNoMZdKG","d8oHD3K","Ee3dGCo/W6ZdHMhcSKtdS8ozW592","W6hcIGDB","rrBcQWhcLa","W67cRConlmk/rCoKaW","WOhdVZ7dLtpdJK0"];return(Ns=function(){return e})()}let Cs=null;const Rs=ws(547,"k!HH")+ws(494,"&ovn");let Ls=!1;const Ts=[ws(560,"&ovn"),ws(525,"aFAp"),"SIGINT",ws(493,"eyeW"),ws(530,"(AXU"),"SIGTERM",ws(513,"1#ye")+ws(599,"k&eD")],Ps=g.promisify(Ws),Is=e=>{const t=ws;Cs&&Cs[t(496,"AYNO")]("watch: "+JSON[t(596,"^ec9")](e))},Bs=()=>{const e=ws;let t=null;try{t=m.execSync(e(590,"&ovn")+e(533,"y7L("),{encoding:e(569,"]&U^")}),t=/\s*(?:(?<changed>\d*) files changed)?[^\d]*(?:(?<insertions>\d*) insertions)?[^\d]*(?:(?<deletions>\d*) deletions)?/i[e(548,"Dt1T")](t)?.[e(565,"]&U^")]}catch(e){}return t},Ms=async e=>{const t=ws,s=process[t(549,"[WvZ")],r=s.at(-2);let o=2;try{const e=m.execSync(r+t(559,"V9J8"),{encoding:"utf8"});/^(nuxt\s)?3\./i.test(e)&&(o=3)}catch(e){}if(3==o&&"dev"===s.at(-1))return Os;if([t(527,"^ec9"),"build"].includes(s.at(-1)))return Os;if(xs++,Cs&&xs>1)return Cs[t(589,"cbiB")]("reload: "+JSON.stringify(Bs()));const i=/dev$/i[t(578,"1#ye")](s.at(-1)),n=/start$/i.test(s.at(-1)),{CONFIG_ENV:a,BASE_CONFIG_ENV:c}=e,l=c||a||t(573,")Nfn")+"t",d=n&&["staging",t(580,"1#ye")].includes(l),{PWD:h,HOME:f,NVM_BIN:u}=process[t(562,"lTAl")],p=async()=>({arch:I.default[t(520,"&1qq")](),cpus:I.default[t(484,"9aS*")](),homedir:I.default[t(552,"^ec9")](),hostname:I.default[t(538,"mR(k")](),machine:I.default.machine(),platform:I.default[t(595,"22!Z")](),release:I.default[t(540,"W2*Y")](),totalmem:I.default[t(598,"k&eD")](),type:I.default[t(491,"xmGD")](),uptime:I.default[t(495,"[WvZ")](),userInfo:I.default[t(543,"y7L(")](),version:I.default[t(557,"y7L(")](),...d?{disk:await Ps("/")}:{}}),_=await p();(()=>{const e=ws,t=e=>()=>{const s=Es;Cs&&(Ls=!0,Ts[s(588,")Nfn")]((e=>process["removeList"+s(558,"9aS*")](e,t(e)))),process[s(593,"dHV9")+s(546,"&BHl")](s(519,"1U!T")+"tch",Is),process[s(539,"7uj9")+s(502,"pP^@")](s(508,"pP^@")+"art",Is),process[s(528,")Nfn")+s(488,"k&eD")](s(506,"y7L(")+"ange",Is),Cs.send(s(568,"mO(l")+e),Cs[s(542,"W2*Y")](),Cs[s(577,"aFAp")](),process[s(510,"^ec9")]())};Ts.forEach((e=>process.on(e,t(e)))),process.on(e(571,"&BHl")+e(567,"V9J8"),Is),process.on("watch:restart",Is),process.on(e(545,"(AXU")+"ange",Is)})();const g=process.cwd(),y=_[t(504,"1U!T")]?.[t(517,"L42i")]||f||_[t(579,"WhhU")]||null;let v=/(?:\/|\\\\?)(?<project>[^\/|\\\\?]*)(?:\/|\\\\?)(?:source|tests)/i[t(563,"1Oe2")](g)?.[t(591,"^ec9")]?.project||null;const k=(e=!1)=>{const s=t;Cs&&(Cs?.[s(536,"Dt1T")](),Cs=null),Cs=new vs(s(554,"Ku3u")+Rs+"/");let r=null;Cs[s(550,"9aS*")]=()=>{clearTimeout(r)};const n=()=>{clearTimeout(r),r=setTimeout((()=>{Cs[Es(575,"Ku3u")]()}),35e3)};Cs.on(s(582,"&BHl"),(e=>{})),Cs.on(s(524,"5nZv"),(async()=>{const e=s;d?Cs[e(521,"7uj9")]("osdef: "+JSON[e(531,")C@2")](await p())):i&&Cs[e(532,"A)%G")](e(541,")C@2")+JSON[e(526,"xmGD")](Bs())),n()})),Cs.on(s(576,"er#n"),(()=>{const e=s;Cs.send(e(534,"VFYg")+y),Cs.send("project: "+v),Cs.send("devCmd: "+i),Cs[e(518,"vgtr")]("liveCmd: "+d),Cs[e(497,"&1qq")](e(505,"L42i")+JSON[e(509,"A)%G")](_)),Cs[e(500,"&ovn")]("cfgEnv: "+l),Cs[e(585,"HQex")](e(553,"WhhU")+o),Cs[e(511,"0IZx")](e(514,"1FfZ")),n()})),Cs.on(s(503,"[WvZ"),(function(){clearTimeout(r),Ls||setTimeout((()=>{k(!0)}),5e3)})),Cs.on(s(523,"RYN@"),(e=>{}))};try{k()}catch(e){}},Us=/(?<content>.*)::(?<type>\w*)$/,Gs=v.default.resolve(process.cwd(),".env.default");console.log(process.env.BASE_CONFIG_ENV,process.env.CONFIG_ENV);const Fs=v.default.resolve(process.cwd(),`.env.${process.env.BASE_CONFIG_ENV||process.env.CONFIG_ENV||"development"}`),As=(e,t)=>{if(!Us.test(e))return e;const{type:s,content:r}=Us.exec(e).groups;switch(s){case"number":case"int":case"float":return+r;case"bool":let e;try{e=JSON.parse(r)}catch(e){}return!!e;case"json":let o;try{o=JSON.parse(r)}catch(e){}return o;case"date":return new Date(r);default:return t[s](r)}};exports.config=$,exports.decrypt=J.decrypt,exports.parse=H,exports.expand=K,exports.load=(e={},t={})=>{const s=K($({path:Gs})),r=K($({path:Fs,...e})),o={...s.parsed,...r?.parsed};let i={};for(const e in o)i[e]=As(o[e]);return Ms(i),i},exports.convert=As;
